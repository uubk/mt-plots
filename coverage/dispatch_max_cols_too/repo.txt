627dd99 Use detail::visit instead of manually unrolled versions
