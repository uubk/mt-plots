a171055 use vector instead of stack for undo stack
